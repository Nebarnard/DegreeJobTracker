@{
    // Get the name of the controller from the route data
    string controllerName = ViewContext.RouteData.Values["controller"] as string;

    // Set default layout
    string layout = "_Layout";

    // Check if the user is logged in
    if (Context.Session.GetString("LoggedIn") == "true")
    {
        // Set admin layout if logged in
        layout = "_AdminLayout";
    } else {
        // Redirect to login if not logged in and not on the HomeController
        if (controllerName != "Home") {
            Layout = "Redirect";
            return;
        } // end if
    } // end else

    // Apply the determined layout
    Layout = layout;
}